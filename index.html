<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>AngularJS $http Decoration with a Cancellation API by igwejk</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>AngularJS $http Decoration with a Cancellation API</h1>
        <p>An $http service decorator that provides a fluent cancellation interface.</p>

        <p class="view"><a href="https://github.com/igwejk/angular-http-decoration-with-cancellation">View the Project on GitHub <small>igwejk/angular-http-decoration-with-cancellation</small></a></p>


        <ul>
          <li><a href="https://github.com/igwejk/angular-http-decoration-with-cancellation/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/igwejk/angular-http-decoration-with-cancellation/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/igwejk/angular-http-decoration-with-cancellation">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h3>
<a id="request-cancellation" class="anchor" href="#request-cancellation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Request Cancellation.</h3>

<p>Some requests may trigger a CPU intensive task at the backend, this could be a behaviour a client understands and appreciates that it cannot be faster. Hence it makes sense to provide the client with an option to cancel the request before it is completed. This feature is also desirable when we want to take mitigating action on realising that a completion of the task would be pointless - consider that a client had started a long running task but decided to navigate away before it completed, one could subscribe to the <code>beforeunload</code> event in anticipation and cancel all pending and unfinished requests in its handler.</p>

<p>The cancellation method is guaranteed to ensure the client does not waste cycles for awaiting the return of a response due to a request. But your backend should implement a cancellation API for this to make a complete sense. How you implement cancellation at the backend is totally up to your design.</p>

<h4>
<a id="client-side-cancellation-with-http" class="anchor" href="#client-side-cancellation-with-http" aria-hidden="true"><span class="octicon octicon-link"></span></a>Client-side Cancellation with $http</h4>

<p>The default implementation of the <a href="https://docs.angularjs.org/api/ng/service/%24http">$http service</a> already exposes a means to achieve client-side cancellation. In its usage, <code>$http(config);</code>, you are required to pass a configuration object. Adding a <code>timeout</code> property to the <code>config</code> object enables the possibility for a cancellation. You should ensure that the property value is either a number or a <a href="https://docs.angularjs.org/api/ng/service/%24q">promise</a>.
If the <code>timeout</code> property value is a number, <code>t</code>, then the request will <em>timeout</em> after <em>t milliseconds</em> and it will be cancelled then. Otherwise, given a <em>promise</em> value, the request will be cancelled when the <em>promise</em> is resolved.</p>

<h4>
<a id="server-side-cancellation" class="anchor" href="#server-side-cancellation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Server-side Cancellation</h4>

<p>Long running operations may be implemented as cancellable tasks (e.g. <a href="https://docs.oracle.com/javase/7/docs/api/index.html?java/util/concurrent/FutureTask.html">FutureTask</a> in Java or <a href="http://msdn.microsoft.com/en-us/library/system.threading.tasks.task%28v=vs.110%29.aspx">Task</a> in .NET). A task triggered by the client may be identified by a unique ID (which would serve as a cancellation token) generated by it and bound to the session on the server. Subsequent requests by the client may specify that an unfinished task mapped to a given token should be cancelled.</p>

<ul>
<li>That was just a very shallow description. Of course one should consider the best practices on the target platform. You shouldn't go spawning threads outside the control of your server container. For instance, if you are working with Java, you should submit your tasks to the container's <a href="https://docs.oracle.com/javaee/7/api/javax/enterprise/concurrent/ManagedExecutorService.html">ManagedExecutorService</a> to run.</li>
</ul>

<h3>
<a id="enabling-a-fluent-and-seamless-cancellation-api-in-angularjs-http-service" class="anchor" href="#enabling-a-fluent-and-seamless-cancellation-api-in-angularjs-http-service" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enabling a Fluent and seamless Cancellation API in AngularJS' $http Service</h3>

<p>There are several ways to do this I suppose. One way could be to simply wrap the $http service. But I wanted to reach my aim in such a way it would not require that I refactor our existing code base, also it should remain Angular. So I decided implementing a decorator was the way to go.</p>

<h4>
<a id="the-http-decorator" class="anchor" href="#the-http-decorator" aria-hidden="true"><span class="octicon octicon-link"></span></a>The $http Decorator:</h4>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>My name is Igwe Kalu (<a href="https://github.com/igwejk" class="user-mention">@igwejk</a>), I am a full-stack developer and I live in Istanbul. I share my experience by this means and you are welcome to use the code snippets or full source code you found here as you will.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/igwejk">igwejk</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>